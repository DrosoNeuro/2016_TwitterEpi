p
p2
p3
p4
t1
t2
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,70,430,40,285),2,3)
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,70,430,40,285),2,3)
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,70,430,40,285),2,3)
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,70,430,80,205),2,3)
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,90,450,80,205),2,3)
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,110,390,80,205),2,3)
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,110,390,60,225),2,3)
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,110,390,70,225),2,3)
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,110,390,70,225),2,3)
c <- matrix(c(30,70,30,70,30,70))
b <- c
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,110,390,70,225),2,3)
c <- matrix(c(30,70,30,70,30,70),2,3)
b <- c
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,110,390,70,225),2,3)
c <- matrix(c(20,80,30,70,40,60),2,3)
b <- c
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,110,390,70,225),2,3)
c <- matrix(c(25,75,30,70,45,65),2,3)
b <- c
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,110,390,70,225),2,3)
c <- matrix(c(25,75,30,70,45,55),2,3)
b <- c
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,110,390,70,225),2,3)
c <- matrix(c(25,75,30,70,35,65),2,3)
b <- c
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,110,390,70,225),2,3)
c <- matrix(c(22,78,30,70,35,65),2,3)
b <- c
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,110,390,70,225),2,3)
c <- matrix(c(20,80,30,70,35,65),2,3)
b <- c
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
crit_val1df <- 3.84
crit_val2df <- 5.99
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,110,390,70,225),2,3)
c <- matrix(c(19,81,30,70,35,65),2,3)
b <- c
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1)
t1
t2 <- -2*(l3-l2)
t2
t3 <- -2*(l3-l1)
t3
crit_val1df <- 3.84
crit_val2df <- 5.99
pmm <- matrix(c(10,35,20,8,20,30,22,8.5,2.3,9,1.5,3),4,4)
pt <- matrix(c(5,6,10,8,19,22,10,7.5,15,5,18,19,2.3,2,5,3,4,7,0.5,1.25,3.5,2,5,8.5),4,4)
pmm
pt
pmm <- dataframe(matrix(c(10,35,20,8,20,30,22,8.5,2.3,9,1.5,3),4,4))
pt <- dataframe(matrix(c(5,6,10,8,19,22,10,7.5,15,5,18,19,2.3,2,5,3,4,7,0.5,1.25,3.5,2,5,8.5),4,4))
pmm <- data.frame(matrix(c(10,35,20,8,20,30,22,8.5,2.3,9,1.5,3),4,4))
pt <- data.frame(matrix(c(5,6,10,8,19,22,10,7.5,15,5,18,19,2.3,2,5,3,4,7,0.5,1.25,3.5,2,5,8.5),4,4))
pmm$time <- pmm[,1]-pmm[,2]
pmm$cost <- pmm[,3]-pmm[,4]
pt$time <- pt[,1]-pt[,2]
pt$time <- pt[,3]-pt[,4]
pmm
ptt
pt
pt$time <- pt[,1]-pt[,2]
pt$cost <- pt[,3]-pt[,4]
pt
pt
pmm <- data.frame(matrix(c(10,35,20,8,20,30,22,8.5,2.3,9,1.5,3),4,4))
pt <- data.frame(matrix(c(5,6,10,8,19,22,10,7.5,15,5,18,19,2.3,2,5,3,4,7,0.5,1.25,3.5,2,5,8.5),6,4))
pmm$time <- pmm[,1]-pmm[,2]
pmm$cost <- pmm[,3]-pmm[,4]
pt$time <- pt[,1]-pt[,2]
pt$cost <- pt[,3]-pt[,4]
pt
plot(pt$time,pt$cost)
plot(pt$time,pt$cost,"ro")
help(plot)
plot(pt$time,pt$cost,xlim=c(-15,15),ylim=c(-6,6),"p")
plot(pt$time,pt$cost,xlim=c(-15,15),ylim=c(-6,6),"p",col="r")
plot(pt$time,pt$cost,xlim=c(-15,15),ylim=c(-6,6),"p",color="r")
plot(pt$time,pt$cost,xlim=c(-15,15),ylim=c(-6,6),pch=0)
warnings()
plot(pt$time,pt$cost,xlim=c(-15,15),ylim=c(-6,6),pch=0,col=1)
plot(pt$time,pt$cost,xlim=c(-15,15),ylim=c(-6,6),pch=0,col=0)
plot(pt$time,pt$cost,xlim=c(-15,15),ylim=c(-6,6),pch=0,col=2)
points(pmm$time,pmm$cost,pch=2,col=3)
pmm$time
pmm$cost
pmm
pmm <- data.frame(matrix(c(10,35,20,8,20,30,22,8.5,2.3,9,1.5,3),4,4))
pmm
pmm <- data.frame(matrix(c(10,35,20,8,20,30,22,8.5,2.3,9,1.5,3,1,12,2,9),4,4))
pt <- data.frame(matrix(c(5,6,10,8,19,22,10,7.5,15,5,18,19,2.3,2,5,3,4,7,0.5,1.25,3.5,2,5,8.5),6,4))
pmm$time <- pmm[,1]-pmm[,2]
pmm$cost <- pmm[,3]-pmm[,4]
pt$time <- pt[,1]-pt[,2]
pt$cost <- pt[,3]-pt[,4]
plot(pt$time,pt$cost,xlim=c(-15,15),ylim=c(-6,6),pch=0,col=2)
points(pmm$time,pmm$cost,pch=2,col=3)
trend <- function(x, beta)
{
y <- beta*x
}
help(lines)
x <- seq(-15,15)
x
trend <- function(x, beta)
{
y <- beta*x
}
beta <- -0.2630
x <- seq(-15,15)
y <- trend(x,beta)
y
x[-1]
x[1]
tail(x,1)
lines(c(x[1],y[1]),c(tail(x,1),tail(y,1)))
tail(y,1)
tail(x,1)
lines(c(x[1],tail(x,1)),c(head(y,1),tail(y,1)))
pmm <- data.frame(matrix(c(10,35,20,8,20,30,22,8.5,2.3,9,1.5,3,1,12,2,9),4,4))
pt <- data.frame(matrix(c(5,6,10,8,19,22,10,7.5,15,5,18,19,2.3,2,5,3,4,7,0.5,1.25,3.5,2,5,8.5),6,4))
pmm$time <- pmm[,1]-pmm[,2]
pmm$cost <- pmm[,3]-pmm[,4]
pt$time <- pt[,1]-pt[,2]
pt$cost <- pt[,3]-pt[,4]
plot(pt$time,pt$cost,xlim=c(-15,15),ylim=c(-6,6),pch=0,col=2)
points(pmm$time,pmm$cost,pch=2,col=3)
trend <- function(x, beta)
{
y <- beta*x
}
beta <- -0.2630
x <- seq(-15,15)
y <- trend(x,beta)
y
lines(c(x[1],tail(x,1)),c(head(y,1),tail(y,1)))
800 +600+500+600
2500*7
a <- matrix(c(15,200,50,450,135,150),2,3)
b  <- matrix(c(30,185,110,390,70,225),2,3)
c <- matrix(c(19,81,30,70,35,65),2,3)
b <- c
p1 <- b[1,1]/(b[1,1]+b[2,1])
p2 <- b[1,2]/(b[1,2]+b[2,2])
p3 <- b[1,3]/(b[1,3]+b[2,3])
p4 <- (b[1,1]+b[1,2])/(b[1,2]+b[1,1]+b[2,2]+b[2,1])
p <- (b[1,1]+b[1,2]+b[1,3])/sum(b)
l1 <-b[1,1]*log(p1)+b[2,1]*log(1-p1) + b[1,2]*log(p2)+b[2,2]*log(1-p2) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l2 <-(b[1,1]+b[1,2])*log(p4)+(b[2,1]+b[2,2])*log(1-p4) + b[1,3]*log(p3)+b[2,3]*log(1-p3)
l3 <- sum(b[1,])*log(p) + sum(b[2,])*log(1-p)
t1 <- -2*(l2-l1) #comparing unrestricted model with model2 in which medium and low income are grouped together (1 df)
t1
t2 <- -2*(l3-l2) #comparing model in which medium and low income are grouped together with completely restricted model (no income classes) (1 df)
t2
t3 <- -2*(l3-l1) #compartin unrestricted model with completely restricted model (i.e. 2 df)
t3
crit_val1df <- 3.84
crit_val2df <- 5.99
250'000/16
)
'
250000/16
15600/9
317*260
317*360
p_eva <- exp(72/100)/(exp(72/100)+exp(834/1000))
p_eva
1-2/100*18-3.75/100*2.1+0.5
p_eva <- exp(72/100)/(exp(72/100)+exp(1.06125))
p-eva
p_eva
-2/100*18-3.75/100*2.1+0.5
p_eva <- exp(72/100)/(exp(72/100)+exp(0.06125))
p_eva
m_binlog <- function(t1,c1,t2,c2,inc,univ)
{
vc <- 1-3/100*t1-6/100*c1+0.5*inc
vt <- -2/100*t2-3.75/100*c2+0.5*univ
p <- exp(vc)/(exp(vc)+exp(vt))
}
p_eva2 <- m_binlog(22,18,2,2.1,1,1)
p_eva2
eva2
p_eva
m_binlog <- function(t1,t2,c1,c2,inc,univ)
{
vc <- 1-3/100*t1-6/100*c1+0.5*inc
vt <- -2/100*t2-3.75/100*c2+0.5*univ
p <- exp(vc)/(exp(vc)+exp(vt))
return(c(vc,vt,p))
}
p_eva2 <- m_binlog(22,18,2,2.1,1,1)
p_eva2
m_binlog <- function(t1,t2,c1,c2,inc,univ)
{
vc <- 1-3/100*t1-6/100*c1+0.5*inc
vt <- -2/100*t2-3.75/100*c2+0.5*univ
p <- exp(vc)/(exp(vc)+exp(vt))
return(p)
}
p_eva2 <- m_binlog(22,18,2,2.1,1,1)
p_eva2
p_matth <- m_binlog(120,100,10,15,0,1)
p_michel <- m_binlog(10,50,3,5,1,0)
p_meri <- m_binlog(25,9,7,2.1,0,0)
p_eva
p_matth
p_meri
p_michel
help(time_zone_converter)
rm(list=ls())
eval_confusion(make_confusion(sick_times,not_sick_times, cut = mean(result$hist)),fOne=TRUE)
make_confusion(sick_times,not_sick_times, cut = mean(result$hist))
leave_one_out <- function(negative, positive, ...)
{
optimal_score = -99999999
getwd()
ls
list
ls()
library("gridExtra") #for saving png files in a specific order into pdf
library("ggplot2")
library('ggdendro')
# library("TSclust")
library("ggmap") #used to plot maps
library("maps")
library("scales") # for function alpha()
library("compiler")  # to speed up the computations!
library("plyr")
library("hexbin") #for hexoganal binning
library("rgeos") #for creating maps
library("png") #for reading png files
library("grid") #for arranging png files
setwd(root_path) # set WD back
load(file="Twitter_datatables2.RData") #use if you decided to export the whole working space
library("gridExtra") #for saving png files in a specific order into pdf
library("ggplot2")
library('ggdendro')
# library("TSclust")
library("ggmap") #used to plot maps
library("maps")
library("scales") # for function alpha()
library("compiler")  # to speed up the computations!
library("plyr")
library("hexbin") #for hexoganal binning
library("rgeos") #for creating maps
library("png") #for reading png files
library("grid") #for arranging png files
library("data.table") #for faster creation of crosstables from data set & for faster searches of datatables; brings about a lot of speed-up! https://github.com/Rdatatable/data.table/wiki/Getting-started
library("bit64") #for loading data with fread
library("lubridate") #for handling time and date information; http://stackoverflow.com/questions/10705328/extract-hours-and-seconds-from-posixct-for-plotting-purposes-in-r
#install_github("rundel/timezone") #needs terminal commands: http://stackoverflow.com/questions/33381421/how-to-upgrade-proj4-for-rgdal
#sudo apt-get install libgdal-dev libproj-dev
library("timezone") #for getting timezones from lat/long data
library("feather") #for fast exporting and importing of data: http://blog.revolutionanalytics.com/2016/05/feather-package.html
#other possibility for fast exporting data
root_path <- "~/Dropbox/UZH_Master/Masterarbeit/TwitterEpi/ExploratoryAnalysis" # defining root_path containing all relevant documents
script_path <- "~/Dropbox/UZH_Master/Masterarbeit/TwitterEpi/Non_R_Code"
setwd(root_path) # set WD back
load(file="Twitter_datatables2.RData") #use if you decided to export the whole working space
gc()

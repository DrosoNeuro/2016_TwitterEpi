/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package user_interface;

import classification.userClassifierBinary;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.PrintStream;
import java.io.UnsupportedEncodingException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import twitter.tweet;

/**
 * Prints the time, id, text and location of tweets
 * @author toddbodnar
 */
public class printReTweets implements twitterprocess
{     
    public printReTweets(String file)
    {
        fileString = file;
        out = null;
        try {
            try {
                out = new PrintStream((new File(file)),"UTF-8");
                //out.println("hi");
            } catch (UnsupportedEncodingException ex) {
                Logger.getLogger(printReTweets.class.getName()).log(Level.SEVERE, null, ex);
            }
        } catch (FileNotFoundException ex) {
            Logger.getLogger(printReTweets.class.getName()).log(Level.SEVERE, null, ex);
        }
        classifier = new userClassifierBinary();
    }
    public printReTweets()
    {
        this("tweets.txt");
    }
    @Override
    public void consume(tweet t) {
        if(t.retweeted_ID==null)
            return;
        
        out.print(t.time+"\t"+t.tweet_id+"\t"+(t.user==null||t.user.id_str==null?"null":t.user.id_str)+"\t");
        
        out.print((t.retweeted_time==null?"null":t.retweeted_time)+"\t"+t.retweeted_ID+"\t"+(t.retweeted_user==null || t.retweeted_user.id_str == null?"null":t.retweeted_user.id_str)+"\t"+t.text.replace("\t", " ")+"\t");
        
        out.println((t.user==null?"null":(classifier.getType(t.user)))+"\t"+(t.retweeted_user==null?"null":(classifier.getType(t.retweeted_user))));
        //out.println(t.time+"\t"+t.tweet_id+"\t"+t.user.id_str+"\t"+t.text+"\t"+(t.boundingbox[0].x+t.boundingbox[1].x)/2.0+"\t"+(t.boundingbox[0].y+t.boundingbox[1].y)/2.0);
    }

    @Override
    public String end() {
        out.close();
        return "done";
    }

    @Override
    public boolean quitAtEnd() {
        return true;
    }
    
    public String toolTip()
    {
        return "Prints retweets to a file";
    }

    @Override
    public String buttonMenu() {
        return "Print ReTweets";
    }

    @Override
    public twitterprocess clone() {
        return new printReTweets(JOptionPane.showInputDialog(null, "File name?"));
    }

    @Override
    public twitterprocess load(String in) {
        return new printReTweets(in);
    }

    @Override
    public String save() {
        return fileString;
    }
    String fileString;
    PrintStream out;
    userClassifierBinary classifier;
}
